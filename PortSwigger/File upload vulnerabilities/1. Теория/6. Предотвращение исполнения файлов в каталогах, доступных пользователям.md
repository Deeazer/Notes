
Хотя лучше всего изначально предотвращать загрузку опасных типов файлов, второй уровень защиты заключается в остановке сервера от запуска любых скриптов, которые могли случайно попасть внутрь системы.
Для предосторожности серверы обычно запускают только те сценарии, чей MIME-тип явно настроен для исполнения. Иначе они могут возвращать какое-то сообщение об ошибке или, в некоторых случаях, отображать содержимое файла как простой текст:

GET /static/exploit.php?command=id HTTP/1.1 
Host: normal-website.com HTTP/1.1 200 OK Content-Type: text/plain Content-Length: 39 
<?php echo system($_GET['command']); ?>

Такое поведение само по себе представляет интерес, поскольку оно потенциально позволяет утечь исходному коду, однако сводит на нет любые попытки создать веб-оболочку.
Этот вид конфигурации часто различается в зависимости от каталога. Каталог, предназначенный для загрузки файлов, предоставляемых пользователями, скорее всего, имеет гораздо более строгие ограничения, чем другие места файловой системы, которые предположительно находятся вне досягаемости конечных пользователей. Если вам удастся найти способ загружать скрипт в другой каталог, который не предназначен для хранения файлов, предоставленных пользователями, сервер может всё-таки запустить ваш сценарий.

Совет:
Веб-серверы часто используют поле имени файла (`filename`) в запросах типа `multipart/form-data`, чтобы определить название и местоположение, куда файл должен быть сохранён.

Также обратите внимание, что даже если вы отправляете все запросы одному доменному имени, оно зачастую указывает на обратный прокси-сервер какого-либо вида, например балансировщик нагрузки. Ваши запросы будут обрабатываться дополнительными серверами в фоновом режиме, которые также могут иметь разные настройки конфигурации.