Эта лаборатория содержит уязвимую функцию загрузки изображений. Сервер настроен таким образом, чтобы предотвратить выполнение файлов, загруженных пользователями, однако эта защита может быть обойдена путем эксплуатации вторичной уязвимости.

Чтобы решить лабораторную работу, загрузите простую оболочку на PHP и используйте её для извлечения содержимого файла `/home/carlos/secret`. Отправьте секрет, используя кнопку, указанную в баннере лаборатории.

Вы можете войти в свою учетную запись, используя следующие учётные данные: `wiener:peter`

Входим в приложение под выданными кредами, далее загружаем exploit.php и отправляем GET-запрос. В ответе видим что выводиться только содержимое файла, без исполнения:
![[Pasted image 20260115114257.png]]

Далее находим запрос, который отправляет наш php файл. В заголовке Content-Disposition вставляем полезную нагрузку на обход директорий:
![[Pasted image 20260115114759.png]]
Видим что сервер удаляет полезную нагрузку. Далее пробуем закодировать символ:
![[Pasted image 20260115114956.png]]
Видим что сервер кодирует URL. Находим наш запрос файлом:
![[Pasted image 20260115115422.png]]
